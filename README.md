Установка:

Если у вас не установлен docker и docker-compose:

docker https://docs.docker.com/engine/install/

docker-compose https://docs.docker.com/compose/install/

1)Клонируем данный репозиторий, в свободную папку.

2)Переходим в папку нашего проекта, где находится файл docker-compose.yml

3)Открываем терминал в текущей директории и прописываем "sudo docker-compose up --build -d postgres rabbitmq" и ждём 10 секунд.
Это необходимо для того, чтобы база данных и rabbitmq успели настроиться быстрее, чем запустится сервис. Иначе, возникнут ошибки подключения сервиса к базе и к rabbitmq.

4)Дальше запускаем сам сервис и воркера: "sudo docker-compose up --build -d web worker".

Работа с сервисом:

POST запрос на url http://0.0.0.0:8080/webhooks/{key} принимает в теле запроса JSON, где key целое число.
Формат сообщения: {"receiver": "+79170000000", "type": "text", "body": "Hello, World!"}.
Сохраняет тело запроса в бд со статусом "received" и отправляет сообщение в rabbitmq в exchange messages с ключом ключ , добавив в тело сообщения
его id. Ответ на запрос: id сообщения в БД (если успешно обработано), сообщение об ошибке (если не успех).

GET запрос на url http://0.0.0.0:8080/messages/{id}, где id = id сообщения в базе данных. Ответ: статус сообщения.

Работа с обработчиком:

При запуске создаёт очередь с именем '{ключ}-queue' и подписывает (bind) её на exchange 'messages' с
заданным ключом.
Обрабатывает поступающие в эту очередь сообщения:

Выводит на экран id, получателя и тело (id, receiver, body) сообщения.

Устанавливает для обработанного сообщения статус в БД Обработано.
